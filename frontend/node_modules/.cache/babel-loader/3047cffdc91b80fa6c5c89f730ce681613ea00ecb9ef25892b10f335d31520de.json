{"ast":null,"code":"var _jsxFileName = \"/Users/anigaabhisathvikreddy/Downloads/frontend/src/pages/RedirectHandler.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { Box, CircularProgress, Typography, Alert } from \"@mui/material\";\nimport { logEvent } from \"../utils/helpers\"; // Assuming logEvent is here\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function RedirectHandler() {\n  _s();\n  const {\n    shortcode\n  } = useParams();\n  const [redirecting, setRedirecting] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const handleRedirect = () => {\n      const storedUrls = JSON.parse(localStorage.getItem(\"shortUrls\") || \"[]\");\n      const urlEntry = storedUrls.find(entry => entry.shortcode === shortcode);\n      if (urlEntry) {\n        const now = new Date();\n        const expires = new Date(urlEntry.expires);\n        if (now < expires) {\n          // Log the click event\n          const updatedClicks = [...urlEntry.clicks, {\n            time: now.toISOString(),\n            source: document.referrer || \"direct\",\n            // Basic source tracking\n            // In a real application, you'd get more sophisticated location data\n            location: \"Unknown\"\n          }];\n          const updatedEntry = {\n            ...urlEntry,\n            clicks: updatedClicks\n          };\n          const updatedUrls = storedUrls.map(entry => entry.shortcode === shortcode ? updatedEntry : entry);\n          localStorage.setItem(\"shortUrls\", JSON.stringify(updatedUrls));\n          logEvent(`Redirected: ${shortcode} to ${urlEntry.original}`, \"info\");\n          window.location.replace(urlEntry.original); // Use replace to prevent back button issues\n        } else {\n          setError(\"This short URL has expired.\");\n          logEvent(`Expired URL access: ${shortcode}`, \"warn\");\n          setRedirecting(false);\n        }\n      } else {\n        setError(\"Short URL not found.\");\n        logEvent(`Non-existent URL access: ${shortcode}`, \"error\");\n        setRedirecting(false);\n      }\n    };\n    handleRedirect();\n  }, [shortcode]);\n  if (redirecting) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      height: \"70vh\",\n      children: [/*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        mt: 2,\n        children: \"Redirecting...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Box, {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    height: \"70vh\",\n    children: error && /*#__PURE__*/_jsxDEV(Alert, {\n      severity: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n_s(RedirectHandler, \"ezTcf/kAbMV9D0iwva95bmzNZZE=\", false, function () {\n  return [useParams];\n});\n_c = RedirectHandler;\nvar _c;\n$RefreshReg$(_c, \"RedirectHandler\");","map":{"version":3,"names":["React","useEffect","useState","useParams","Box","CircularProgress","Typography","Alert","logEvent","jsxDEV","_jsxDEV","RedirectHandler","_s","shortcode","redirecting","setRedirecting","error","setError","handleRedirect","storedUrls","JSON","parse","localStorage","getItem","urlEntry","find","entry","now","Date","expires","updatedClicks","clicks","time","toISOString","source","document","referrer","location","updatedEntry","updatedUrls","map","setItem","stringify","original","window","replace","display","flexDirection","alignItems","justifyContent","height","children","fileName","_jsxFileName","lineNumber","columnNumber","variant","mt","severity","_c","$RefreshReg$"],"sources":["/Users/anigaabhisathvikreddy/Downloads/frontend/src/pages/RedirectHandler.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { Box, CircularProgress, Typography, Alert } from \"@mui/material\";\nimport { logEvent } from \"../utils/helpers\"; // Assuming logEvent is here\n\nexport default function RedirectHandler() {\n  const { shortcode } = useParams();\n  const [redirecting, setRedirecting] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const handleRedirect = () => {\n      const storedUrls = JSON.parse(localStorage.getItem(\"shortUrls\") || \"[]\");\n      const urlEntry = storedUrls.find((entry) => entry.shortcode === shortcode);\n\n      if (urlEntry) {\n        const now = new Date();\n        const expires = new Date(urlEntry.expires);\n\n        if (now < expires) {\n          // Log the click event\n          const updatedClicks = [\n            ...urlEntry.clicks,\n            {\n              time: now.toISOString(),\n              source: document.referrer || \"direct\", // Basic source tracking\n              // In a real application, you'd get more sophisticated location data\n              location: \"Unknown\", \n            },\n          ];\n          const updatedEntry = { ...urlEntry, clicks: updatedClicks };\n\n          const updatedUrls = storedUrls.map((entry) =>\n            entry.shortcode === shortcode ? updatedEntry : entry\n          );\n          localStorage.setItem(\"shortUrls\", JSON.stringify(updatedUrls));\n          logEvent(`Redirected: ${shortcode} to ${urlEntry.original}`, \"info\");\n          window.location.replace(urlEntry.original); // Use replace to prevent back button issues\n        } else {\n          setError(\"This short URL has expired.\");\n          logEvent(`Expired URL access: ${shortcode}`, \"warn\");\n          setRedirecting(false);\n        }\n      } else {\n        setError(\"Short URL not found.\");\n        logEvent(`Non-existent URL access: ${shortcode}`, \"error\");\n        setRedirecting(false);\n      }\n    };\n\n    handleRedirect();\n  }, [shortcode]);\n\n  if (redirecting) {\n    return (\n      <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\" justifyContent=\"center\" height=\"70vh\">\n        <CircularProgress />\n        <Typography variant=\"h6\" mt={2}>\n          Redirecting...\n        </Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" alignItems=\"center\" justifyContent=\"center\" height=\"70vh\">\n      {error && <Alert severity=\"error\">{error}</Alert>}\n    </Box>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}